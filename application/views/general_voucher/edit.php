<?phpdefined('BASEPATH') OR exit('No direct script access allowed');/*$type = user_limit();$scount = supplier_count();$limit = $type['coun'] + $scount['scount'];*/$this->load->view('layout/header');?><style type="text/css">    .form-group{        min-height: 75px;    }</style><div class="content-wrapper">    <div class="fixed-breadcrumb">        <ol class="breadcrumb abs-ol">            <li><a href="<?php echo base_url('auth/dashboard'); ?>"><i class="fa fa-dashboard"></i> Dashboard</a></li>            <li><a href="<?php echo base_url('general_voucher'); ?>">General Voucher</a></li>            <li class="active">Add General Voucher</li>        </ol>    </div>    <section class="content mt-50">        <div class="row">            <div class="col-md-12">                <div class="box">                    <div class="box-header with-border">                        <h3 class="box-title">Edit General Voucher</h3>                        <a class="btn btn-default pull-right back_button" id="cancel" onclick1="cancel('')">Back</a>                    </div>                    <div class="box-body">                                               <form role="form" id="form" method="post" action="<?php echo base_url('general_voucher/edit_general_voucher'); ?>">                            <div class="row">                                <div class="col-sm-3">                                    <div class="form-group">                                        <label for="date">Voucher Date <span class="validation-color">*</span></label>                                        <?php                                            $financial_year = explode('-', $this->session->userdata('SESS_FINANCIAL_YEAR_TITLE'));                                            if ((date("Y") != $financial_year[0]) && (date("Y") != $financial_year[1])) {                                                $date = '01-04-'.$financial_year[0];                                            } else {                                                $date = date('d-m-Y');                                            }                                            ?>                                        <div class="input-group date">                                            <input type="text" class="form-control datepicker" id="voucher_date" name="voucher_date" value="<?php echo date('d-m-Y', strtotime($data[0]->voucher_date)); ?>" >                                            <div class="input-group-addon">                                                <i class="fa fa-calendar"></i>                                            </div>                                        </div>                                        <span class="validation-color" id="err_voucher_date"></span>                                    </div>                                </div>                                <div class="col-sm-3">                                                                      <div class="form-group">                                        <label for="customer">Transaction Purpose <span class="validation-color">*</span></label>                                             <select class="form-control select2" autofocus="on" id="trans_purpose" name="trans_purpose" style="width: 100%;">                                                <option value="">Select</option>                                                <?php                                                foreach($transaction_purpose as $value){                                                    if($data[0]->transaction_purpose_id == $value->id){                                                        echo "<option value='".$value->id."' selected>".$value->purpose_option."</option>";                                                    }else{                                                       echo "<option value='".$value->id."'>".$value->purpose_option."</option>";                                                    }                                                                                                }                                                ?>                                            </select>                                                                         <span class="validation-color" id="err_customer"></span>                                    </div>                                </div>                                <div class="col-sm-3" id="div_receipt" style="display: none">                                    <div class="form-group">                                        <label for="amount" id="lbl_amount">Amount <span class="validation-color">*</span></label>                                            <input type="hidden" class="form-control" id="general_voucher_id" name="general_voucher_id" value="<?php echo $data[0]->journal_voucher_id;?>">                                        <input type="hidden" class="form-control" id="voucher_number" name="voucher_number" value="<?php echo $data[0]->voucher_number;?>">                                        <input type="text" class="float_number form-control" id="receipt_amount" name="receipt_amount" value="<?php echo precise_amount($data[0]->amount);?>">                                        <span class="validation-color" id="err_receipt_amount"><?php echo form_error('receipt_amount'); ?></span>                                    </div>                                </div>                                 <div class="col-sm-4" style="display: none">                                    <div class="form-group">                                        <label for="customer">Payee <span class="validation-color">*</span></label>                                                  <div class="input-group">                                                <div class="input-group-addon">                                                    <a data-backdrop="static" data-keyboard="false" href="#" data-toggle="modal" data-target="#customer_modal" data-reference_type="general_voucher" class="open_customer_modal pull-right">+</a></div>                                                    <input type="hidden" class="form-control" id="customer_module_id" name="customer_module_id" value="<?= $customer_module_id ?>" >                                                    <input type="hidden" class="form-control" id="privilege" name="privilege" value="<?= $privilege ?>" >                                                <select class="form-control select2" autofocus="on" id="payee" name="payee" style="width: 100%;">                                                    <option value="">Select</option>                                                          </select>                                        </div>                                        <span class="validation-color" id="err_customer"></span>                                    </div>                                </div>                                                                                                <div class="col-sm-3" id="div_interest" style="display: none">                                        <div class="form-group">                                            <label for="Interest" id="lbl_interest">Interest </label>                                            <input type="text" class="float_number form-control" id="interest_amount" name="interest_amount" value="<?php echo precise_amount($data[0]->interest_expense_amount);?>">                                        <span class="validation-color" id="err_interest_amount"><?php echo form_error('interest_amount'); ?></span>                                        </div>                                    </div>                                    <div class="col-sm-3" id="div_others" style="display: none">                                        <div class="form-group">                                            <label for="others" id="lbl_others">Others </label>                                            <input type="text" class="float_number form-control" id="others_amount" name="others_amount" value="<?php echo precise_amount($data[0]->others_amount);?>">                                        <span class="validation-color" id="err_others_amount"><?php echo form_error('others'); ?></span>                                        </div>                                    </div>                                                                           <div class="col-sm-3" id="div_cgst" style="display: none">                                        <div class="form-group">                                            <label for="cgst">CGST </label>                                            <input type="text" class="float_number form-control" id="txt_cgst" name="txt_cgst" value="<?php echo $data[0]->cgst;?>">                                        <span class="validation-color" id="err_txt_cgst"><?php echo form_error('cgst'); ?></span>                                        </div>                                    </div>                                     <div class="col-sm-3" id="div_sgst" style="display: none">                                        <div class="form-group">                                            <label for="sgst">SGST </label>                                            <input type="text" class="float_number form-control" id="txt_sgst" name="txt_sgst" value="<?php echo $data[0]->sgst;?>">                                        <span class="validation-color" id="err_txt_sgst"><?php echo form_error('sgst'); ?></span>                                        </div>                                    </div>                                     <div class="col-sm-3" id="div_igst" style="display: none">                                        <div class="form-group">                                            <label for="igst">IGST </label>                                            <input type="text" class="float_number form-control" id="txt_igst" name="txt_igst" value="<?php echo $data[0]->igst;?>">                                        <span class="validation-color" id="err_txt_igst"><?php echo form_error('igst'); ?></span>                                        </div>                                    </div> <div class="col-sm-3" id="div_utgst" style="display: none">                                        <div class="form-group">                                            <label for="utgst" >UTGST </label>                                            <input type="text" class="float_number form-control" id="txt_utgst" name="txt_utgst" value="<?php echo $data[0]->utgst;?>">                                        <span class="validation-color" id="err_txt_utgst"><?php echo form_error('utgst'); ?></span>                                        </div>                                    </div>                                     <div class="col-sm-3" id="div_cess" style="display: none">                                        <div class="form-group">                                            <label for="cess">Cess </label>                                            <input type="text" class="float_number form-control" id="txt_cess" name="txt_cess" value="<?php echo $data[0]->cess;?>">                                        <span class="validation-color" id="err_txt_cess"><?php echo form_error('cess'); ?></span>                                        </div>                                    </div>                                    <div class="col-sm-3" id="div_tds" style="display: none">                                        <div class="form-group">                                            <label for="tds">TDS </label>                                            <input type="text" class="float_number form-control" id="txt_tds" name="txt_tds" value="<?php echo $data[0]->tds;?>">                                        <span class="validation-color" id="err_txt_tds"><?php echo form_error('tds'); ?></span>                                        </div>                                    </div>                                               <div class="col-sm-3" id="trans_mode" style="display: none;">                                    <div class="form-group">                                        <label for="paying_by">Mode of Payment <span class="validation-color">* </span></label>                                        <?php                                                                            if( $category == 'Cash Receipt/Received from unknown' ||  $category == 'Cash Paid/Payment to unknown' ){                                            ?>                                            <select class="form-control select2" id="payment_mode" name="payment_mode">                                                <option value="">Select</option>                                                <?php                                                 $cash_sel = '';                                                if($data[0]->transaction_mode == 'cash'){                                                    $cash_sel = 'selected';                                                }                                                 ?>                                                 <option value="cash" <?php echo $cash_sel;?>>Cash</option>                                            </select>                                            <?php                                            }else if($category == 'Cash withdrawal from bank' || $category == 'Cash deposited in bank' || $category == 'Bank Receipt/Received from unknown' || $category == 'Bank Paid/Payment to unknown'){                                                ?>                                                <select class="form-control select2" id="payment_mode" name="payment_mode">                                                <option value="">Select</option>                                                               <?php                                                  foreach ($bank_account as $key => $value) {                                                        if($value->bank_account_id == $data[0]->transaction_mode){                                                             ?>                                                        <option value='<?php echo $value->bank_account_id . "/" . $value->ledger_title ?>' selected> <?php echo $value->ledger_title; ?> </option>                                                        <?php                                                        }else{                                                        ?>                                                        <option value='<?php echo $value->bank_account_id . "/" . $value->ledger_title ?>'> <?php echo $value->ledger_title; ?> </option>                                                        <?php                                                        }                                                    }                                                ?>                                            </select>                                                <?php                                            }else if($category != 'Cash deposited in bank' || $category != 'Bank Receipt/Received from unknown' || $category != 'Bank Paid/Payment to unknown' || $category != 'Cash withdrawal from bank' || $category != 'Cash Receipt/Received from unknown' ||  $category != 'Cash Paid/Payment to unknown'){                                                ?>                                                <select class="form-control select2" id="payment_mode" name="payment_mode">                                                <option value="">Select</option>                                                <?php                                                 $cash_sel = '';                                                if($data[0]->transaction_mode == 'cash'){                                                    $cash_sel = 'selected';                                                }                                                 ?>                                                <option value="cash" <?php echo $cash_sel;?>>Cash</option>                                                  <?php                                                  foreach ($bank_account as $key => $value) {                                                        if($value->bank_account_id == $data[0]->transaction_mode){                                                             ?>                                                        <option value='<?php echo $value->bank_account_id . "/" . $value->ledger_title ?>' selected> <?php echo $value->ledger_title; ?> </option>                                                        <?php                                                        }else{                                                        ?>                                                        <option value='<?php echo $value->bank_account_id . "/" . $value->ledger_title ?>'> <?php echo $value->ledger_title; ?> </option>                                                        <?php                                                        }                                                    }                                                ?>                                            </select>                                             <?php                                               }                                            ?>                                             <span class="validation-color" id="err_payment_mode"></span>                                        </div>                                                                           </div>                                                                <div id="hide" >                                                                   <div class="col-sm-3">                                        <div class="form-group">                                            <label for="cheque_no">Cheque/Reference Number</label>                                            <input type="text" class="form-control" id="cheque_number" name="cheque_number" value="<?php echo $data[0]->cheque_number;?>">                                            <span class="validation-color" id="err_cheque_number"></span>                                        </div>                                    </div>                                    <div class="col-sm-3">                                                                      <div class="form-group">                                            <label for="cheque_date">Cheque/Reference Date</label>                                            <div class="input-group date">                                                <?php if($data[0]->cheque_date != '0000-00-00'){                                                    $cheque_date = date('d-m-Y', strtotime($data[0]->cheque_date));                                                }else{                                                   $cheque_date = '' ;                                                }                                                ?>                                                <input type="text" class="form-control datepicker" id="cheque_date" name="cheque_date" value="<?php echo $cheque_date;?>"><div class="input-group-addon">                                                    <i class="fa fa-calendar"></i>                                                </div>                                            </div>                                            <span class="validation-color" id="err_cheque_date"></span>                                        </div>                                    </div>                                </div>                                <div class="col-sm-5" id="div_partner" style="display: none;">                                    <div class="form-group">                                        <label for="cheque_date" id="partner">Shareholder / Partner</label>                                        <select class="form-control select2" id="cmb_partner" name="cmb_partner">                                            <option value="">Select</option>                                            <?php                                            foreach ($sharholder as $key => $value) {                                                if($data[0]->partner_shareholder_id == $value->id){                                                    echo '<option value="'. $value->id .'" selected>'.$value->sharholder_name .'</option>';                                                }else{                                                    echo '<option value="'. $value->id .'">'.$value->sharholder_name .'</option>';                                                }                                            }                                            ?>                                        </select>                                        <span class="validation-color" id="err_partner"></span>                                    </div>                                </div>                                <div id="other_payment" style="display: none;">                                    <div class="col-sm-3">                                        <div class="form-group">                                            <label for="bank_name">Payment Via</label>                                            <input type="text" class="form-control" id="payment_via" name="payment_via" value="">                                            <span class="validation-color" id="err_payment_via"></span>                                        </div>                                    </div>                                    <div class="col-sm-3">                                        <div class="form-group">                                            <label for="bank_name">Reference Number</label>                                            <input type="text" class="form-control" id="ref_number" name="ref_number" value="">                                            <span class="validation-color" id="err_ref_number"></span>                                        </div>                                    </div>                                </div>                            <input type="hidden" name="voucher_type" id="voucher_type" value="<?php echo $voucher_type;?>">                            <input type="hidden" name="input_type" id="input_type" value="<?php echo $input_type;?>">                            <input type="hidden" name="transaction_purpose" id="transaction_purpose" value="<?php echo $purpose;?>">                            <input type="hidden" name="transaction_cat" id="transaction_cat" value="<?php echo $category;?>">                                                            <div class="col-sm-12">                                    <div class="form-group">                                        <label for="paying_by">Comments</label>                                        <textarea type="text" class="form-control" id="description" name="description"><?php echo $data[0]->narration;?></textarea>                                    </div>                                </div>                            </div>                                                        <div class="row">                                <div class="col-sm-12">                                    <div class="box-footer">                                        <button type="submit" id="general_submit" class="btn btn-info">Update</button>                                        <span class="btn btn-default" id="receipt_cancel" onclick="cancel('general_voucher/general_voucher_list')">Cancel</span>                                    </div>                                </div>                            </div>                        </form>                                        </div>                </div>            </div>        </div>    </section></div><?php //$this->load->view('bank_account/bank_modal'); ?><?php$this->load->view('layout/footer');//$this->load->view('customer/customer_modal');//$this->load->view('category/category_modal');//$this->load->view('subcategory/subcategory_modal');?><script src="<?php echo base_url('assets/js/vouchers/') ?>general_voucher.js"></script><script src="<?php echo base_url('assets/js/vouchers/') ?>general_voucher_submit.js"></script><script type="text/javascript">    $(document).ready(function () {        $('.cust_type .select2').select2({            minimumResultsForSearch: -1        });    });    //$('#hide').hide();  $(document).ready(function (){        var payment_mode = '<?php echo $data[0]->from_account;?>';        if (payment_mode == null || payment_mode == "") {            $('#hide').hide();            $("#other_payment").hide();                    } else {            if (payment_mode != "cash" && payment_mode != "" && payment_mode != "others" ) {                //&& payment_mode == "bank"                console.log('inside');                $('#hide').show();                $("#other_payment").hide();                            }else{                $('#hide').hide();                $("#bank_name").val('');                $("#cheque_number").val('');                $("#cheque_date").val('');            }            if (payment_mode != "cash" && payment_mode != "" && payment_mode != "bank" && payment_mode == "other payment mode") {                $("#other_payment").show();                $('#hide').hide();                $("#bank_name").val('');                $("#cheque_number").val('');                $("#cheque_date").val('');            }else{                $("#other_payment").hide();                $("#payment_via").val('');                $("#ref_number").val('');            }        }    });          $(document).ready(function (){                var voucher_type = '<?php echo $voucher_type;?>';                var input_type = '<?php echo $input_type;?>';                var transaction_purpose = '<?php echo $purpose;?>';                var trans_category = '<?php echo $category;?>';                $('#voucher_type').val(voucher_type);                $('#input_type').val(input_type);                $('#transaction_purpose').val(transaction_purpose);                $("#lbl_amount").html('Amount<span class="validation-color">*</span>');                 if(trans_category == 'Advance Tax Refund by Govt' || trans_category == 'Deposit Amount Withdrawal from FD' || trans_category == 'Deposit Amount Withdrawal from RD'){                    $("#div_interest").show();                    $("#lbl_interest").text('Interest');                    $("#div_others").hide();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_receipt").show();                    $("#div_tds").hide();                }else if(trans_category == 'Cash deposited in bank'){                    $("#div_interest").show();                    $("#lbl_interest").text('Charges');                    $("#div_others").hide();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_receipt").show();                    $("#div_tds").hide();                }else if(trans_category == 'Cash withdrawal from bank'){                    $("#div_interest").show();                    $("#lbl_interest").text('Charges');                    $("#div_others").hide();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_receipt").show();                    $("#div_tds").hide();                }else if(trans_category == 'Advance repaid by vendor' || trans_category == 'Deposit Amount Withdrawal from RENT' || trans_category == 'Deposit Amount Withdrawal from ELECTRICITY' || trans_category == 'Deposit Amount Withdrawal from WATER' || trans_category == 'Deposit Amount Withdrawal from (other)'){                    $("#div_interest").show();                    $("#lbl_interest").text('Other Charges');                    $("#div_others").hide();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_receipt").show();                    $("#div_tds").hide();                }else if(trans_category == 'Purchase of Fixed Asset'){                    $("#div_interest").show();                    $("#lbl_interest").text('Other Charges');                    $("#div_others").hide();                    $("#div_cess").show();                    $("#div_sgst").show();                    $("#div_utgst").show();                    $("#div_cgst").show();                    $("#div_igst").show();                    $("#div_receipt").show();                    $("#div_tds").hide();                    $("#lbl_amount").html('Purchase Price<span class="validation-color">*</span>');                }else if(trans_category == 'Sales/Disposal of Fixed Asset'){                    $("#div_receipt").show();                    $("#lbl_interest").text('Gain');                    $("#lbl_others").text('Loss');                    $("#div_interest").show();                    $("#div_others").show();                                        $("#div_cess").show();                    $("#div_sgst").show();                    $("#div_utgst").show();                    $("#div_cgst").show();                    $("#div_igst").show();                    $("#div_tds").hide();                    $("#lbl_amount").html('Taxable Value<span class="validation-color">*</span>');                }else if(trans_category == 'GST Payable' || trans_category == 'Tax received from GST' ){                    $("#div_interest").hide();                    $("#div_receipt").hide();                    $("#div_others").hide();                    $("#div_cess").show();                    $("#div_sgst").show();                    $("#div_utgst").show();                    $("#div_cgst").show();                    $("#div_igst").show();                    $("#div_tds").hide();                }else if(trans_category == 'Tax paid to INCOME TAX' || trans_category == 'Tax received from Income Tax' ){                    $("#div_interest").show();                    $("#div_receipt").show();                    $("#div_others").show();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_tds").hide();                }else if(transaction_purpose == 'Investments' && voucher_type == 'RECEIPTS'){                    $("#lbl_interest").text('Gain');                    $("#lbl_others").text('Loss');                    $("#div_interest").show();                    $("#div_others").show();                    $("#div_receipt").show();                    $("#lbl_amount").html('Amount<span class="validation-color">*</span>');                }else if(transaction_purpose == 'Loan Borrowed and repaid'  && voucher_type == 'PAYMENT'){                    $("#lbl_interest").text('Interest');                    $("#lbl_others").text('Others');                    $("#div_interest").show();                    $("#div_others").show();                     $("#div_receipt").show();                    $("#lbl_amount").html('Principal Amount<span class="validation-color">*</span>');                                   }else{                    $("#div_interest").hide();                    $("#div_others").hide();                    $("#div_receipt").show();                    $("#div_cess").hide();                    $("#div_sgst").hide();                    $("#div_utgst").hide();                    $("#div_cgst").hide();                    $("#div_igst").hide();                    $("#div_tds").hide();                    $("#lbl_amount").html('Amount<span class="validation-color">*</span>');                }                                if(input_type == 'interest fixed' || input_type == 'interest recurring' || input_type == 'interest other' || input_type == 'interest liability'){                    $("#trans_mode").hide();                    $("#div_tds").show();                    $('#hide').hide();                }else{                    $("#trans_mode").show();                    $("#div_tds").hide();                }                if(input_type == 'partner' || input_type == 'shareholder'){                    $("#div_partner").show();                                        if(input_type == 'partner'){                        $("#partner").html(input_type+'<span class="validation-color">*</span>');                        $("#err_partner").text('');                      }else{                     $("#partner").text(input_type);                        $("#err_partner").text('');                    }                }                                if(trans_category == 'Equity shares issued to shareholder' || trans_category == 'Preference share issue to shareholders'){                    $("#div_interest").show();                    $("#lbl_interest").text('Security Premium');                }                            });</script> 