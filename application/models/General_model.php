<?php
defined('BASEPATH') OR exit('No direct script access allowed');
class General_model extends CI_Model{
    function __construct(){
        parent::__construct();
    }
    public function insertData($table, $data){
        $data1 = $this->db->escape_str($data);
        if ($this->db->insert($table, $data1)){
            return $this->db->insert_id();
        }
        else
        {
            return false;
        }
    }
    public function GetProductName(){
        $this->db->select('LOWER(product_name) as product_name');
        $this->db->from('products');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetProductName_leathercraft(){
        $this->db->select("LOWER(REPLACE(product_name, ' ', '')) as product_name");
        $this->db->from('products');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetServiceName(){
        $this->db->select('LOWER(service_name) as service_name');
        $this->db->from('services');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetCategory_bulk($type){
        $this->db->select('category_id,LOWER(category_name) as category_name');
        $this->db->from('category');
        $this->db->where('category_type', $type);
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetCategory_bulk_leathercraft($type){
        $this->db->select("category_id,LOWER(REPLACE(category_name, ' ', '')) as category_name");
        $this->db->from('category');
        $this->db->where('category_type', $type);
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }

    public function GetBrand_bulk($type){
        $this->db->select('brand_id,LOWER(brand_name) as brand_name');
        $this->db->from('brand');
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetBrand_bulk_leathercraft($type){
        $this->db->select("brand_id,LOWER(REPLACE(brand_name, ' ', '')) as brand_name");
        $this->db->from('brand');
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }

    public function GetSubCategory_bulk($type){
        $this->db->select('su.sub_category_id,su.category_id as category_id_sub,LOWER(su.sub_category_name) as subcategory_name');
        $this->db->from('sub_category su');
        $this->db->join('category ca', 'su.category_id = ca.category_id');
        $this->db->where('ca.category_type', $type);
        $this->db->where('su.delete_status', '0');
        $this->db->where('su.branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function GetSubCategory_bulk_leathercraft($type){
        $this->db->select("su.sub_category_id,su.category_id as category_id_sub,LOWER(REPLACE(su.sub_category_name, ' ', '')) as subcategory_name");
        $this->db->from('sub_category su');
        $this->db->join('category ca', 'su.category_id = ca.category_id');
        $this->db->where('ca.category_type', $type);
        $this->db->where('su.delete_status', '0');
        $this->db->where('su.branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function Get_uqc_bulk_latest($type){
        $this->db->select('id as uom_id,LOWER(uom) as uom');
        $this->db->from('uqc');
        $this->db->where('delete_status', '0');
        $this->db->where('uom_type', $type);
        $this->db->or_where('uom_type', 'both');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }

     public function Get_uqc_bulk_leathercraft($type){
        $this->db->select("id as uom_id,LOWER(REPLACE(description, ' ', '')) as uom");
        $this->db->from('uqc');
        $this->db->where('delete_status', '0');
        $this->db->where('uom_type', $type);
        $this->db->or_where('uom_type', 'both');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    
    public function Get_uom_bulk(){
        $this->db->select('id as uom_id,LOWER(uom) as uom');
        $this->db->from('uqc');
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function Get_tax_bulk($tax){
        $this->db->select('tax_id,TRUNCATE(tax_value,2) as tax_value');
        $this->db->from('tax');
        $this->db->where('tax_name', $tax);
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function Get_discount_bulk(){
        $this->db->select('discount_id,TRUNCATE(discount_value,2) as discount_value');
        $this->db->from('discount');
        $this->db->where('delete_status', '0');
        $this->db->where('branch_id', $this->session->userdata('SESS_BRANCH_ID'));
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function hsn_call_product_bulk(){
        $this->db->select('hsn_code');
        $this->db->from('hsn');
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function customer_bulk_country(){
        $this->db->select('country_id,LOWER(country_name) as country_name');
        $this->db->from('countries');
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function customer_bulk_state(){
        $this->db->select('country_id, state_id, LOWER(state_name) as state_name');
        $this->db->from('states');
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function customer_bulk_city(){
        $this->db->select('state_id, city_id, LOWER(city_name) as city_name');
        $this->db->from('cities');
        $this->db->where('delete_status', '0');
        $query = $this->db->get(); 
      
      return $query->result_array();
    }
    public function insertBatchData($table, $data){
        $data1 = $this->db->escape_str($data);
        if ($this->db->insert_batch($table, $data1)){
            return true;
        }else{
            return false;
        }
    }
    public function updateData($table, $data, $where){
        $data1 = $this->db->escape_str($data);
        $this->db->where($where);
        if ($this->db->update($table, $data1)){
            return TRUE;
        }else{
            return FALSE;
        }
    }
    public function getRecords($string, $table, $where = "", $order = "", $group_by = ""){
        $this->db->select($string);
        $this->db->from($table);
        if ($where != "")
        {
            $this->db->where($where);
        } if ($group_by != "")
        {
            $this->db->group_by($group_by);
        } if ($order != "")
        {
            foreach ($order as $key => $value)
            {
                $this->db->order_by($key, $value);
            }
        }
        $res = $this->db->get()->result();
        foreach ($res as $key => $value)
        {
            foreach ($value as $k => $val)
            {
                $res[$key]->$k = str_replace("\'", "'", $val);
            }
        }
        return $res;
    }
    public function getJoinRecords($string, $table, $where, $join, $order = "", $group = ""){
        $this->db->select($string);
        $this->db->from("$table");
        if ($join != "")
        {
            foreach ($join as $key => $value)
            {
                $val = explode('#', $value);
                if (isset($val[1]))
                {
                    $this->db->join("$key", $val[0], $val[1]);
                }
                else
                {
                    $this->db->join("$key", $val[0]);
                }
            }
        } $this->db->where($where);
        if ($order != "")
        {
            foreach ($order as $key => $value)
            {
                $this->db->order_by($key, $value);
            }
        } if ($group != "")
        {
            foreach ($group as $key => $value)
            {
                $this->db->group_by($value);
            }
        }
        // return $this->db->get()->result();
        $res = $this->db->get()->result();
        foreach ($res as $key => $value)
        {
            foreach ($value as $k => $val)
            {
                $res[$key]->$k = str_replace("\'", "'", $val);
            }
        }
        return $res;
    }
    public function getPageJoinRecordsCount($list_data)
    {
        $this->db->select($list_data['string']);
        $this->db->from($list_data['table']);
        if (isset($list_data['join']) && $list_data['join'] != "")
        {
            foreach ($list_data['join'] as $key => $value)
            {
                $val = explode('#', $value);
                if (isset($val[1]))
                {
                    $this->db->join($key, $val[0], $val[1]);
                }
                else
                {
                    $this->db->join($key, $val[0]);
                }
            }
        } $this->db->where($list_data['where']);
        $i = 0;
        if (isset($list_data['search']) && $list_data['search'] != "all")
        {
            $this->db->group_start();
            $this->db->like($list_data['filter'][0], $list_data['search']);
            for ($i = 1; $i < count($list_data['filter']); $i++)
            {
                $this->db->or_like($list_data['filter'][$i], $list_data['search']);
            } $this->db->group_end();
        } if (isset($list_data['order']) && $list_data['order'] != "")
        {
            foreach ($list_data['order'] as $key => $value)
            {
                $this->db->order_by($key, $value);
            }
        } if (isset($list_data['group']) && $list_data['group'] != "")
        {
            foreach ($list_data['group'] as $key => $value)
            {
                $this->db->group_by($value);
            }
        } $subquery = $this->db->get_compiled_select();
        $i        = 0;
        $this->db->select('t.*')->from('(' . $subquery . ') t');
         if (isset($list_data['order']) && $list_data['order'] != "")
        {
            foreach ($list_data['order'] as $key => $value)
            {
                $key_val=explode(".", $key);
                $key_result=$key_val[0];
                if(isset($key_val[1]))
                {
                $key_result=$key_val[1];
                }
                
                $this->db->order_by('t.'.$key_result, $value);
            }
        } 
        if (!empty($list_data['filter_search'])){
             /********** GST Report Starts***************/
            if ($list_data['section'] == "sales_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 0);
                            $this->db->where($where);
                        }
                        else
                        {
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 0);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }

            /********** GST Report Ends***************/

            /********** HSN Report starts***************/
            if($list_data['section'] == "sales_hsn"){

                //hsn no
                 if ($list_data['filter_search']['filter_hsn'] != "" && !empty($list_data['filter_search']['filter_hsn'])){
                        $dat_arr = explode(",", $list_data['filter_search']['filter_hsn']);
                        $j       = 0;
                        foreach ($dat_arr as $key => $value){
                            if ($i == 0 || $j == 0){
                                $this->db->group_start();
                                $this->db->where('t.hsn_sac_code', $value);
                            } else {
                                $this->db->or_where('t.hsn_sac_code', $value);
                            } $i++;
                            $j++;
                        } $this->db->group_end();
                    }

                //UOM

                if ($list_data['filter_search']['filter_uqc'] != "" && !empty($list_data['filter_search']['filter_uqc'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uqc']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.unit_id', $value);
                        } else {
                            $this->db->or_where('t.unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //invoice Value  
                if ($list_data['filter_search']['filter_from_total_amount'] != "" && !empty($list_data['filter_search']['filter_from_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_total_amount'] != "" && !empty($list_data['filter_search']['filter_to_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //IGST Value  
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount >=', $value);
                        }  $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                  //CGST Value  
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        }  $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Cess

                if ($list_data['filter_search']['filter_from_cess_amount'] != "" && !empty($list_data['filter_search']['filter_from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cess_amount'] != "" && !empty($list_data['filter_search']['filter_to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

            }
            /********** HSN Report Ends***************/

                /********** GST Report CREDIT NOTE Starts***************/
            if ($list_data['section'] == "sales_credit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                 if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report CREDIT NOTE  Ends***************/

            /********** GST Report DEBIT NOTE Starts***************/
            if ($list_data['section'] == "sales_debit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report DEBIT NOTE  Ends***************/
             if ($list_data['section'] == "tcs_sales_payable") {
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_pan'] != "" && !empty($list_data['filter_search']['filter_pan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_pan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_pan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value  >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value   >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
    if ($list_data['section'] == "tds_sales_payable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_tan_number <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_tan_number <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tds_amount'] != "" && !empty($list_data['filter_search']['filter_from_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tds_amount'] != "" && !empty($list_data['filter_search']['filter_to_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_percentage'] != "" && !empty($list_data['filter_search']['filter_tds_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_section'] != "" && !empty($list_data['filter_search']['filter_tds_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
             if ($list_data['section'] == "tcs_purcahse_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.purchase_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
        if ($list_data['section'] == "tds_expense_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "sales") {
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sales_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_sales_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_sales'] != "" && !empty($list_data['filter_search']['filter_igst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_sales'] != "" && !empty($list_data['filter_search']['filter_igst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_due_day'] != "" && !empty($list_data['filter_search']['filter_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_due_day'] != "" && !empty($list_data['filter_search']['filter_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_billing_to'] != "" && !empty($list_data['filter_search']['filter_billing_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_payable_on_reverse_charge'] != "" && !empty($list_data['filter_search']['filter_payable_on_reverse_charge']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payable_on_reverse_charge']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                 if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "recipt_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.sales_id)', $value);
                        }
                        else
                        {
                            
                            $this->db->or_where('(t.sales_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //reciept amount starts
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                 //reciept amount starts main_receipt_amount 1
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 //reciept amount ends

                //reciept amount starts main_receipt_amount 2
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //from_other_charges starts 
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_other_charges ends

                //starts round_off 
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //reciept amount starts pending_amount
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept pending_amount

                //received_amount starts 
                if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //received_amount ends

                if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_total', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_total', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // elseif ($list_data['section'] == "purchase")
            // {
            //     if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.receivable_date', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.receivable_date', $value);
            //             } $j++;
            //             $i++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_date >=', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_date >=', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_date <=', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_date <=', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 if ($value == 'pending')
            //                 {
            //                     $this->db->where('t.purchase_paid_amount', 0);
            //                 }
            //                 else if ($value == 'partial')
            //                 {
            //                     $this->db->where('t.purchase_paid_amount >', 0);
            //                     $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) >', 0);
            //                 }
            //                 else if ($value == 'completed')
            //                 {
            //                     $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) <=', 0);
            //                 }
            //             }
            //             else
            //             {
            //                 if ($value == 'pending')
            //                 {
            //                     $this->db->or_where('t.purchase_paid_amount', 0);
            //                 }
            //                 else if ($value == 'partial')
            //                 {
            //                     $this->db->or_where('t.purchase_paid_amount >', 0);
            //                     $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) >', 0);
            //                 }
            //                 else if ($value == 'completed')
            //                 {
            //                     $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) <=', 0);
            //                 }
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.supplier_id', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.supplier_id', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_id', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_id', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount)', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount)', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_paid_amount', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_paid_amount', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount)', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount)', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.due', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.due', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     }
            // }
            elseif ($list_data['section'] == "credit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "debit_note"){
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "purchase")
            {
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_supplier_invoice_from'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_invoice_to'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_from'] != "" && !empty($list_data['filter_search']['filter_order_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_order_to'] != "" && !empty($list_data['filter_search']['filter_order_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pur_from_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_pur_to_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_number'] != "" && !empty($list_data['filter_search']['filter_order_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_dilevery_number'] != "" && !empty($list_data['filter_search']['filter_dilevery_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_dilevery_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_delivery_challan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_delivery_challan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_e_way_billing'] != "" && !empty($list_data['filter_search']['filter_e_way_billing']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_e_way_billing']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_e_way_bill_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_e_way_bill_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "purchase_debit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_grand_total)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_billing_country_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_nature_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_nature_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_type_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_type_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_supplier_debit_note_number)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_supplier_debit_note_number)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_taxable_value'] != "" && !empty($list_data['filter_search']['filter_taxable_value']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_taxable_value']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/* if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "purchase_credit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }  if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }   
            } elseif ($list_data['section'] == "expense_bill") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_type_of_expence'] != "" && !empty($list_data['filter_search']['filter_type_of_expence']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_invoice_number'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_tds_from_expence'] != "" && !empty($list_data['filter_search']['filter_tds_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_tds_to_expence'] != "" && !empty($list_data['filter_search']['filter_tds_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_tds'] != "" && !empty($list_data['filter_search']['filter_tds']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_cgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_expence'] != "" && !empty($list_data['filter_search']['filter_igst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_expence'] != "" && !empty($list_data['filter_search']['filter_igst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/* if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_ex_from_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_ex_to_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } elseif ($list_data['section'] == "payment_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }



                //from_paid_amount starts
                if ($list_data['filter_search']['from_paid_amount'] != "" && !empty($list_data['filter_search']['from_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_paid_amount'] != "" && !empty($list_data['filter_search']['to_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_paid_amount ends


                //from_total_paid_amount starts
                if ($list_data['filter_search']['from_total_paid_amount'] != "" && !empty($list_data['filter_search']['from_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_total_paid_amount'] != "" && !empty($list_data['filter_search']['to_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_total_paid_amount ends


                //from_gain_loss starts
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_gain_loss ends

                //from_discount starts
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_discount ends

                //from_other_charges starts
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_other_charges'] != "" && !empty($list_data['filter_search']['to_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_round_off starts
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }else{
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_pending_amount starts
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }else{
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_pending_amount ends

                //from_invoice_amount starts
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount <=', $value);
                        }else{
                            $this->db->or_where('t.invoice_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_invoice_amount ends

                if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_converted_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_converted_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_number', $value);
                        }
                        else
                        {
                            
                            $this->db->or_where('t.reference_number', $value);
                        } $i++;
                        $j++;                        
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_paid_amount'] != "" && !empty($list_data['filter_search']['filter_paid_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.receipt_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.receipt_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_total_paid_amount'] != "" && !empty($list_data['filter_search']['filter_total_paid_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_voucher_type'] != "" && !empty($list_data['filter_search']['filter_voucher_type']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher_type']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_voucher_type', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_voucher_type', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "advance_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_mode'] != "" && !empty($list_data['filter_search']['filter_payment_mode']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.advance_voucher_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.advance_voucher_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst_from_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_from_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_to_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                /*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                

                 //Taxable amount starts
                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends


                if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.billing_state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_tax_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_tax_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            elseif ($list_data['section'] == "refund_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst_from_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_from_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_to_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */
                if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_id =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_id =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.refund_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.refund_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 




                if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //refund amount starts
                if ($list_data['filter_search']['filter_from_refund_amount'] != "" && !empty($list_data['filter_search']['filter_from_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_refund_amount'] != "" && !empty($list_data['filter_search']['filter_to_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                 //refund amount ends

                //billing country starts
                if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country'])) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //billing country ends

                //place of supply starts
                if ($list_data['filter_search']['filter_place_of_supply'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //place of supply ends

                 //Billing Currency starts
                if ($list_data['filter_search']['filter_billing_currency'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Billing Currency ends

                

                 //Payment Mode starts
                if ($list_data['filter_search']['filter_payment_mode'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.to_account', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.to_account', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Payment Mode ends

                //Taxable amount starts
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['filter_from_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends



                 if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
              
            }

            

             if ($list_data['section'] == "sales_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // Sales stock

            if ($list_data['section'] == "purchase_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // Purchase stock

            if ($list_data['section'] == "close_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // Closing Stock
            if ($list_data['section'] == "leads"){
                if ($list_data['filter_search']['filter_asr_no'] != "" && !empty($list_data['filter_search']['filter_asr_no']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_asr_no']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_group'] != "" && !empty($list_data['filter_search']['filter_group']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_group']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.group', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.group', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_stages'] != "" && !empty($list_data['filter_search']['filter_stages']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_stages']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.stages', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.stages', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_source'] != "" && !empty($list_data['filter_search']['filter_source']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_source']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.source', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.source', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_business_type'] != "" && !empty($list_data['filter_search']['filter_business_type']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_business_type']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.business_type', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.business_type', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_next_action_date'] != "" && !empty($list_data['filter_search']['filter_from_next_action_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_next_action_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.next_action_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.next_action_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_to_next_action_date'] != "" && !empty($list_data['filter_search']['filter_to_next_action_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_next_action_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.next_action_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.next_action_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_priority'] != "" && !empty($list_data['filter_search']['filter_priority']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_priority']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.priority', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.priority', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
        }$query = $this->db->get();
        return $query->num_rows();
    }
    public function getPageJoinRecordsCount1($list_data, $string)
    {
        $this->db->select($list_data['string']);
        $this->db->from($list_data['table']);
        if (isset($list_data['join']) && $list_data['join'] != "")
        {
            foreach ($list_data['join'] as $key => $value)
            {
                $val = explode('#', $value);
                if (isset($val[1]))
                {
                    $this->db->join($key, $val[0], $val[1]);
                }
                else
                {
                    $this->db->join($key, $val[0]);
                }
            }
        } $this->db->where($list_data['where']);
        $i = 0;
        if (isset($list_data['search']) && $list_data['search'] != "all")
        {
            $this->db->group_start();
            $this->db->like($list_data['filter'][0], $list_data['search']);
            for ($i = 1; $i < count($list_data['filter']); $i++)
            {
                $this->db->or_like($list_data['filter'][$i], $list_data['search']);
            } $this->db->group_end();
        } if (isset($list_data['order']) && $list_data['order'] != "")
        {
            foreach ($list_data['order'] as $key => $value)
            {
                $this->db->order_by($key, $value);
            }
        }
        if (isset($list_data['group']) && $list_data['group'] != "")
        {
            foreach ($list_data['group'] as $key => $value)
            {
                $this->db->group_by($value);
            }
        }
        $subquery = $this->db->get_compiled_select();
        $i        = 0;
        $this->db->select('t.*,' . $string)->from('(' . $subquery . ') t');
         if (isset($list_data['order']) && $list_data['order'] != "")
        {
            foreach ($list_data['order'] as $key => $value)
            {
                $key_val=explode(".", $key);
                $key_result=$key_val[0];
                if(isset($key_val[1]))
                {
                $key_result=$key_val[1];
                }
                
                $this->db->order_by('t.'.$key_result, $value);
            }
        } 
        if (!empty($list_data['filter_search']))
        {
             /********** GST Report Starts***************/
            if ($list_data['section'] == "sales_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                /* if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report Ends***************/

            /********** HSN Report starts***************/
            if($list_data['section'] == "sales_hsn"){

                //hsn no
                 if ($list_data['filter_search']['filter_hsn'] != "" && !empty($list_data['filter_search']['filter_hsn'])){
                        $dat_arr = explode(",", $list_data['filter_search']['filter_hsn']);
                        $j       = 0;
                        foreach ($dat_arr as $key => $value){
                            if ($i == 0 || $j == 0){
                                $this->db->group_start();
                                $this->db->where('t.hsn_sac_code', $value);
                            } else {
                                $this->db->or_where('t.hsn_sac_code', $value);
                            } $i++;
                            $j++;
                        } $this->db->group_end();
                    }

                //UOM

                if ($list_data['filter_search']['filter_uqc'] != "" && !empty($list_data['filter_search']['filter_uqc'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uqc']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.unit_id', $value);
                        } else {
                            $this->db->or_where('t.unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                
                //Qty

                if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //invoice Value  
                if ($list_data['filter_search']['filter_from_total_amount'] != "" && !empty($list_data['filter_search']['filter_from_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_total_amount'] != "" && !empty($list_data['filter_search']['filter_to_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //IGST Value  
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                  //CGST Value  
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        }  $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Cess

                if ($list_data['filter_search']['filter_from_cess_amount'] != "" && !empty($list_data['filter_search']['filter_from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cess_amount'] != "" && !empty($list_data['filter_search']['filter_to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** HSN Report Ends***************/

                /********** GST Report CREDIT NOTE Starts***************/
            if ($list_data['section'] == "sales_credit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();                            
                            $this->db->where('t.sales_credit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report CREDIT NOTE  Ends***************/

            /********** GST Report DEBIT NOTE Starts***************/
            if ($list_data['section'] == "sales_debit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report DEBIT NOTE  Ends***************/
             if ($list_data['section'] == "tcs_sales_payable") {
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_pan'] != "" && !empty($list_data['filter_search']['filter_pan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_pan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_pan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value  >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value   >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
    if ($list_data['section'] == "tds_sales_payable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_tan_number <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_tan_number <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tds_amount'] != "" && !empty($list_data['filter_search']['filter_from_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tds_amount'] != "" && !empty($list_data['filter_search']['filter_to_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_percentage'] != "" && !empty($list_data['filter_search']['filter_tds_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_section'] != "" && !empty($list_data['filter_search']['filter_tds_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
             if ($list_data['section'] == "tcs_purcahse_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.purchase_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
        if ($list_data['section'] == "tds_expense_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }

            if ($list_data['section'] == "sales") {
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sales_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_sales_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_due_day'] != "" && !empty($list_data['filter_search']['filter_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_due_day'] != "" && !empty($list_data['filter_search']['filter_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_sales'] != "" && !empty($list_data['filter_search']['filter_igst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_sales'] != "" && !empty($list_data['filter_search']['filter_igst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_billing_to'] != "" && !empty($list_data['filter_search']['filter_billing_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_payable_on_reverse_charge'] != "" && !empty($list_data['filter_search']['filter_payable_on_reverse_charge']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payable_on_reverse_charge']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                 if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "credit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 /*if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } elseif ($list_data['section'] == "debit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "" )
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }  if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "recipt_voucher") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //reciept amount starts main_receipt_amount
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 //reciept amount ends

                //reciept amount starts main_receipt_amount 1
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //reciept amount starts main_receipt_amount 2
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //from_other_charges starts 
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_other_charges ends

                //starts round_off 
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //reciept amount starts pending_amount
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept pending_amount

                //received_amount starts 
                if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //received_amount ends

                 if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }  if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.sales_id)',$value);
                        }
                        else
                        {
                           
                            $this->db->or_where('(t.sales_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_total', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_total', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "purchase") {
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_supplier_invoice_from'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_invoice_to'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_from'] != "" && !empty($list_data['filter_search']['filter_order_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_order_to'] != "" && !empty($list_data['filter_search']['filter_order_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pur_from_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_pur_to_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_number'] != "" && !empty($list_data['filter_search']['filter_order_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_dilevery_number'] != "" && !empty($list_data['filter_search']['filter_dilevery_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_dilevery_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_delivery_challan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_delivery_challan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_e_way_billing'] != "" && !empty($list_data['filter_search']['filter_e_way_billing']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_e_way_billing']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_e_way_bill_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_e_way_bill_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "purchase_debit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_grand_total)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_billing_country_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_nature_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_nature_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_type_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_type_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_supplier_debit_note_number)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_supplier_debit_note_number)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_taxable_value'] != "" && !empty($list_data['filter_search']['filter_taxable_value']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_taxable_value']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/* if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "purchase_credit_note") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "" && !empty($list_data['filter_search']['filter_place_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_tax_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_tax_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */
                /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } elseif ($list_data['section'] == "payment_voucher") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                

                //from_paid_amount starts
                if ($list_data['filter_search']['from_paid_amount'] != "" && !empty($list_data['filter_search']['from_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_paid_amount'] != "" && !empty($list_data['filter_search']['to_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_paid_amount ends


                //from_total_paid_amount starts
                if ($list_data['filter_search']['from_total_paid_amount'] != "" && !empty($list_data['filter_search']['from_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_total_paid_amount'] != "" && !empty($list_data['filter_search']['to_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_total_paid_amount ends


                //from_gain_loss starts
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_gain_loss ends

                //from_discount starts
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_discount ends

                //from_other_charges starts
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_other_charges'] != "" && !empty($list_data['filter_search']['to_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_round_off starts
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }else{
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_pending_amount starts
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }else{
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_pending_amount ends

                //from_invoice_amount starts
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount <=', $value);
                        }else{
                            $this->db->or_where('t.invoice_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_invoice_amount ends

                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_converted_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_converted_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_number', $value);
                        }
                        else
                        {
                            
                            $this->db->or_where('t.reference_number', $value);
                        } $i++;
                        $j++;                        
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_paid_amount'] != "" && !empty($list_data['filter_search']['filter_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.receipt_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.receipt_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_total_paid_amount'] != "" && !empty($list_data['filter_search']['filter_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_voucher_type'] != "" && !empty($list_data['filter_search']['filter_voucher_type']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher_type']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_voucher_type', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_voucher_type', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "advance_voucher") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_mode'] != "" && !empty($list_data['filter_search']['filter_payment_mode']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.advance_voucher_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.advance_voucher_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_from_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_to_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                 //Taxable amount starts
                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.billing_state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_tax_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_tax_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            } elseif ($list_data['section'] == "refund_voucher") {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst_from_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_from_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_to_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_id =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_id =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.refund_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.refund_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 


                //refund amount starts
                if ($list_data['filter_search']['filter_from_refund_amount'] != "" && !empty($list_data['filter_search']['filter_from_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_refund_amount'] != "" && !empty($list_data['filter_search']['filter_to_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                 //refund amount ends

                //billing country starts
                if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country'])) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //billing country ends

                //place of supply starts
               
                if ($list_data['filter_search']['filter_place_of_supply'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //place of supply ends
                 //Billing Currency starts
                if ($list_data['filter_search']['filter_billing_currency'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Billing Currency ends

                //Payment Mode starts
                if ($list_data['filter_search']['filter_payment_mode'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.to_account', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.to_account', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Payment Mode ends

                //Taxable amount starts
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['filter_from_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                


                if ($list_data['filter_search']['filter_received_amount'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                
            }elseif ($list_data['section'] == "expense_bill")  {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_type_of_expence'] != "" && !empty($list_data['filter_search']['filter_type_of_expence']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_invoice_number'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_tds_from_expence'] != "" && !empty($list_data['filter_search']['filter_tds_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_tds_to_expence'] != "" && !empty($list_data['filter_search']['filter_tds_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_tds'] != "" && !empty($list_data['filter_search']['filter_tds']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_cgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_expence'] != "" && !empty($list_data['filter_search']['filter_igst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_expence'] != "" && !empty($list_data['filter_search']['filter_igst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_ex_from_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_ex_to_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } 
            // elseif ($list_data['section'] == "purchase")
            // {
            //     if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.receivable_date', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.receivable_date', $value);
            //             } $j++;
            //             $i++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_date >=', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_date >=', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_date <=', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_date <=', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 if ($value == 'pending')
            //                 {
            //                     $this->db->where('t.purchase_paid_amount', 0);
            //                 }
            //                 else if ($value == 'partial')
            //                 {
            //                     $this->db->where('t.purchase_paid_amount >', 0);
            //                     $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) >', 0);
            //                 }
            //                 else if ($value == 'completed')
            //                 {
            //                     $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) <=', 0);
            //                 }
            //             }
            //             else
            //             {
            //                 if ($value == 'pending')
            //                 {
            //                     $this->db->or_where('t.purchase_paid_amount', 0);
            //                 }
            //                 else if ($value == 'partial')
            //                 {
            //                     $this->db->or_where('t.purchase_paid_amount >', 0);
            //                     $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) >', 0);
            //                 }
            //                 else if ($value == 'completed')
            //                 {
            //                     $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount) <=', 0);
            //                 }
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.supplier_id', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.supplier_id', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_id', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_id', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount)', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount)', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.purchase_paid_amount', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.purchase_paid_amount', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount)', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('(t.purchase_grand_total+t.credit_note_amount-t.debit_note_amount-t.purchase_paid_amount)', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
            //     {
            //         $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
            //         $j       = 0;
            //         foreach ($dat_arr as $key => $value)
            //         {
            //             if ($i == 0 || $j == 0)
            //             {
            //                 $this->db->group_start();
            //                 $this->db->where('t.due', $value);
            //             }
            //             else
            //             {
            //                 $this->db->or_where('t.due', $value);
            //             } $i++;
            //             $j++;
            //         } $this->db->group_end();
            //     }
            // }
        }$query = $this->db->get();
        return $query->result();
    }
    public function getPageJoinRecords($list_data)
    {
        $this->db->select($list_data['string']);
        $this->db->from($list_data['table']);
        if (isset($list_data['join']) && $list_data['join'] != "")
        {
            foreach ($list_data['join'] as $key => $value)
            {
                $val = explode('#', $value);
                if (isset($val[1]))
                {
                    $this->db->join($key, $val[0], $val[1]);
                }
                else
                {
                    $this->db->join($key, $val[0]);
                }
            }
        } $this->db->where($list_data['where']);
        $i = 0;
        if (isset($list_data['search']) && $list_data['search'] != "all")
        {
            $this->db->group_start();
            $this->db->like($list_data['filter'][0], $list_data['search']);
            for ($i = 1; $i < count($list_data['filter']); $i++)
            {
                $this->db->or_like($list_data['filter'][$i], $list_data['search']);
            } $this->db->group_end();
        } 
       
        if (isset($list_data['group']) && $list_data['group'] != "")
        {
            foreach ($list_data['group'] as $key => $value)
            {
                $this->db->group_by($value);
            }
        }
         $subquery = $this->db->get_compiled_select();
        $i        = 0;
        $this->db->select('t.*')->from('(' . $subquery . ') t');
         if (isset($list_data['order']) && $list_data['order'] != "")
        {
            foreach ($list_data['order'] as $key => $value)
            {
                $key_val=explode(".", $key);
                $key_result=$key_val[0];
                if(isset($key_val[1]))
                {
                $key_result=$key_val[1];
                }
                
                $this->db->order_by('t.'.$key_result, $value);
            }
        } 
        if (!empty($list_data['filter_search'])){

             /********** GST Report Starts***************/
            if ($list_data['section'] == "sales_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report Ends***************/

            /********** HSN Report starts***************/
            if($list_data['section'] == "sales_hsn"){

                //hsn no
                 if ($list_data['filter_search']['filter_hsn'] != "" && !empty($list_data['filter_search']['filter_hsn'])){
                        $dat_arr = explode(",", $list_data['filter_search']['filter_hsn']);
                        $j       = 0;
                        foreach ($dat_arr as $key => $value){
                            if ($i == 0 || $j == 0){
                                $this->db->group_start();
                                $this->db->where('t.hsn_sac_code', $value);
                            } else {
                                $this->db->or_where('t.hsn_sac_code', $value);
                            } $i++;
                            $j++;
                        } $this->db->group_end();
                    }

                //UOM

                if ($list_data['filter_search']['filter_uqc'] != "" && !empty($list_data['filter_search']['filter_uqc'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uqc']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.unit_id', $value);
                        } else {
                            $this->db->or_where('t.unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //invoice Value  
                if ($list_data['filter_search']['filter_from_total_amount'] != "" && !empty($list_data['filter_search']['filter_from_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_total_amount'] != "" && !empty($list_data['filter_search']['filter_to_total_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_total_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //IGST Value  
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                  //CGST Value  
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //sgst
                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount >=', $value);
                        }  $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Cess

                if ($list_data['filter_search']['filter_from_cess_amount'] != "" && !empty($list_data['filter_search']['filter_from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cess_amount'] != "" && !empty($list_data['filter_search']['filter_to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

            }
            /********** HSN Report Ends***************/

                /********** GST Report CREDIT NOTE Starts***************/
            if ($list_data['section'] == "sales_credit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                 if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount 

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_credit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_credit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report CREDIT NOTE  Ends***************/

            /********** GST Report DEBIT NOTE Starts***************/
            if ($list_data['section'] == "sales_debit_note_gst"){

                //voucher no
                if ($list_data['filter_search']['filter_voucher'] != "" && !empty($list_data['filter_search']['filter_voucher'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //customer

                 if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //GSTIN

                 if ($list_data['filter_search']['filter_gstin'] != "" && !empty($list_data['filter_search']['filter_gstin'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gstin']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_gstin_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_gstin_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice number

                 if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                
                //invoice Date               
                if ($list_data['filter_search']['from_date'] != "" && !empty($list_data['filter_search']['from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_date'] != "" && !empty($list_data['filter_search']['to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //invoice Value  
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //HSN

                 if ($list_data['filter_search']['filter_hsn_number'] != "" && !empty($list_data['filter_search']['filter_hsn_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_hsn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_hsn_sac_code', $value);
                        } else {
                            $this->db->or_where('t.product_hsn_sac_code', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //Qty

                 if ($list_data['filter_search']['filter_quantity'] != "" && !empty($list_data['filter_search']['filter_quantity'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_quantity']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_quantity', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_quantity', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //UOM

                 if ($list_data['filter_search']['filter_uom'] != "" && !empty($list_data['filter_search']['filter_uom'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_uom']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.product_unit_id', $value);
                        } else {
                            $this->db->or_where('t.product_unit_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //Rate

                 /*if ($list_data['filter_search']['filter_price'] != "" && !empty($list_data['filter_search']['filter_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_unit_price', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/

                if ($list_data['filter_search']['filter_from_price'] != "" && !empty($list_data['filter_search']['filter_from_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_price'] != "" && !empty($list_data['filter_search']['filter_to_price'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_price']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_unit_price <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_unit_price <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Place of Supply

                 if ($list_data['filter_search']['filter_place_of_supply'] != ""){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //GST Rate

                 if ($list_data['filter_search']['filter_gst_rate'] != "" && !empty($list_data['filter_search']['filter_gst_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //CGST Value  
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // SGST  Amount

                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //IGST Value  
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // UTGST  Amount

                if ($list_data['filter_search']['from_ugst_amount'] != "" && !empty($list_data['filter_search']['from_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        } else{
                            $where = array('t.sales_debit_note_item_sgst_amount >= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_ugst_amount'] != "" && !empty($list_data['filter_search']['to_ugst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_ugst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->where($where);
                        }
                        else{
                            $where = array('t.sales_debit_note_item_sgst_amount <= ' => $value , 't.is_utgst ' => 1);
                            $this->db->or_where($where);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                //CESS Rate

                 if ($list_data['filter_search']['filter_cess_rate'] != "" && !empty($list_data['filter_search']['filter_cess_rate'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cess_rate']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } else {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                // Taxable  Amount

                if ($list_data['filter_search']['from_cess_amount'] != "" && !empty($list_data['filter_search']['from_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cess_amount'] != "" && !empty($list_data['filter_search']['to_cess_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cess_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_item_tax_cess_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


            }
            /********** GST Report DEBIT NOTE  Ends***************/

            if ($list_data['section'] == "tcs_sales_payable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_pan'] != "" && !empty($list_data['filter_search']['filter_pan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_pan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_pan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "tds_sales_payable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_tan_number <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_tan_number <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tds_amount'] != "" && !empty($list_data['filter_search']['filter_from_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tds_amount'] != "" && !empty($list_data['filter_search']['filter_to_tds_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tds_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_percentage'] != "" && !empty($list_data['filter_search']['filter_tds_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.sales_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tds_section'] != "" && !empty($list_data['filter_search']['filter_tds_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "tcs_purcahse_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);

                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.purchase_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "tds_expense_recievable"){
                if ($list_data['filter_search']['filter_customer'] != "" && !empty($list_data['filter_search']['filter_customer'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tan'] != "" && !empty($list_data['filter_search']['filter_tan'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tan']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_tan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_tan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_from_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_tcs_amount'] != "" && !empty($list_data['filter_search']['filter_to_tcs_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_tcs_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_percentage'] != "" && !empty($list_data['filter_search']['filter_tcs_percentage'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_percentage']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_percentage', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_percentage', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tcs_section'] != "" && !empty($list_data['filter_search']['filter_tcs_section'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tcs_section']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0){
                            $this->db->group_start();
                            $this->db->where('t.section_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.section_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "sales"){
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sales_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_sales_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sales_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_sales_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sales_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_due_day'] != "" && !empty($list_data['filter_search']['filter_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_due_day'] != "" && !empty($list_data['filter_search']['filter_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_to'] != "" && !empty($list_data['filter_search']['filter_billing_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_payable_on_reverse_charge'] != "" && !empty($list_data['filter_search']['filter_payable_on_reverse_charge']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payable_on_reverse_charge']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_cgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_sgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_sales'] != "" && !empty($list_data['filter_search']['filter_utgst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_sales'] != "" && !empty($list_data['filter_search']['filter_igst_from_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_sales'] != "" && !empty($list_data['filter_search']['filter_igst_to_sales'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_sales']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
               /* if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                /*if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                 if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }elseif ($list_data['section'] == "purchase"){
                if ($list_data['filter_search']['filter_receivable_date'] != "" && !empty($list_data['filter_search']['filter_receivable_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_receivable_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receivable_date', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receivable_date', $value);
                        } $j++;
                        $i++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_supplier_invoice_from'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_invoice_to'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_from'] != "" && !empty($list_data['filter_search']['filter_order_from']))
                { 
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_order_to'] != "" && !empty($list_data['filter_search']['filter_order_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pur_from_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_pur_to_due_day'] != "" && !empty($list_data['filter_search']['filter_pur_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pur_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_order_number'] != "" && !empty($list_data['filter_search']['filter_order_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_order_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_order_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_order_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_dilevery_number'] != "" && !empty($list_data['filter_search']['filter_dilevery_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_dilevery_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_delivery_challan_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_delivery_challan_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_e_way_billing'] != "" && !empty($list_data['filter_search']['filter_e_way_billing']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_e_way_billing']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_e_way_bill_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_e_way_bill_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.converted_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.converted_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.converted_credit_note_amount-t.converted_debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }elseif ($list_data['section'] == "expense_bill"){
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            if ($value == 'pending')
                            {
                                $this->db->where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->where('t.converted_paid_amount >', 0);
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        }
                        else
                        {
                            if ($value == 'pending')
                            {
                                $this->db->or_where('t.converted_paid_amount', 0);
                            }
                            else if ($value == 'partial')
                            {
                                $this->db->or_where('t.converted_paid_amount >', 0);
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) >', 0);
                            }
                            else if ($value == 'completed')
                            {
                                $this->db->or_where('(t.currency_converted_amount-t.converted_paid_amount) <=', 0);
                            }
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.supplier_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.supplier_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_type_of_expence'] != "" && !empty($list_data['filter_search']['filter_type_of_expence']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_invoice_number'] != "" && !empty($list_data['filter_search']['filter_supplier_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_supplier_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_supplier_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_tds_from_expence'] != "" && !empty($list_data['filter_search']['filter_tds_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_tds_to_expence'] != "" && !empty($list_data['filter_search']['filter_tds_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_tds'] != "" && !empty($list_data['filter_search']['filter_tds']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tds']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_tds_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_tds_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_cgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_cgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_sgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_expence'] != "" && !empty($list_data['filter_search']['filter_utgst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_expence'] != "" && !empty($list_data['filter_search']['filter_igst_from_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_expence'] != "" && !empty($list_data['filter_search']['filter_igst_to_expence'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_expence']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.expense_bill_item_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.expense_bill_item_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_ex_from_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_from_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_from_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_ex_to_due_day'] != "" && !empty($list_data['filter_search']['filter_ex_to_due_day'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_ex_to_due_day']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.currency_converted_amount+t.credit_note_amount-t.debit_note_amount-t.converted_paid_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.due', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.due', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } if ($list_data['section'] == "credit_note"){
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                 /*if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } if ($list_data['section'] == "debit_note")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_of_supply'] != "" && !empty($list_data['filter_search']['filter_nature_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_name'] != "" && !empty($list_data['filter_search']['filter_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_shipping_to'] != "" && !empty($list_data['filter_search']['filter_shipping_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_shipping_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.ship_to_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.ship_to_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_billing_name'] != "" && !empty($list_data['filter_search']['filter_customer_billing_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_billing_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {

                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cur_currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cur_currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_cgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
        
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.debit_note_grand_total)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_received_amount'] != "" && !empty($list_data['filter_search']['filter_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sales_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sales_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.debit_note_nature_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.debit_note_nature_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } if ($list_data['section'] == "purchase_debit_note")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_grand_total)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_billing_country_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_nature_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_nature_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_billing_state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_billing_state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_debit_note_type_of_supply)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_debit_note_type_of_supply)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.purchase_supplier_debit_note_number)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.purchase_supplier_debit_note_number)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_debit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_debit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_taxable_value'] != "" && !empty($list_data['filter_search']['filter_taxable_value']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_taxable_value']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_dn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_dn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_dn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                /*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_debit_note_amount'] != "" && !empty($list_data['filter_search']['filter_debit_note_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_debit_note_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_debit_note_grand_total', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_debit_note_grand_total', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            } if ($list_data['section'] == "purchase_credit_note")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_invoice_number =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_invoice_number =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_invoice_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_invoice_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */if ($list_data['filter_search']['filter_nature_supply'] != "" && !empty($list_data['filter_search']['filter_nature_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_nature_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_nature_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_nature_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_place_of_supply'] != "")
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_type_of_supply'] != "" && !empty($list_data['filter_search']['filter_type_of_supply']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_type_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_type_of_supply', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_type_of_supply', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_number'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_number', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_number', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_supplier_cn_from'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_from']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_from']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_cn_to'] != "" && !empty($list_data['filter_search']['filter_supplier_cn_to']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_cn_to']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_supplier_credit_note_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_supplier_credit_note_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_cgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_cgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_sgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_sgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_utgst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst_from_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_from_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_from_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst_to_purchase_cn'] != "" && !empty($list_data['filter_search']['filter_igst_to_purchase_cn'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst_to_purchase_cn']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ if ($list_data['filter_search']['filter_gst_payable'] != "" && !empty($list_data['filter_search']['filter_gst_payable']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_gst_payable']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_gst_payable', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_gst_payable', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_from_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_grand_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_grand_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }/*if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_tax_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_tax_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } */
                /*if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_taxable_value', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_taxable_value', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/ /*if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.debit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.debit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_cgst'] != "" && !empty($list_data['filter_search']['filter_cgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_cgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.purchase_credit_note_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.purchase_credit_note_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/
            }
            if ($list_data['section'] == "recipt_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }  

                //reciept amount starts
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                 //reciept amount starts main_receipt_amount 1
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //reciept amount starts main_receipt_amount 2
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //from_other_charges starts 
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_other_charges'] != "" && !empty($list_data['filter_search']['to_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_other_charges ends

                //starts round_off 
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                //reciept amount starts pending_amount
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept pending_amount

                //received_amount starts from_received_amount
                if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_total_paid <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_total_paid <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.customer_payable_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.customer_payable_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //received_amount ends

                if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.sales_id)', $value);
                        }
                        else
                        {                            
                            $this->db->or_where('(t.sales_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                 if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.to_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.to_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_total', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_total', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "payment_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['from_received_amount'] != "" && !empty($list_data['filter_search']['from_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['from_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['to_received_amount'] != "" && !empty($list_data['filter_search']['to_received_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['to_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.total_received_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.total_received_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.from_account =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_supplier_name'] != "" && !empty($list_data['filter_search']['filter_supplier_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_supplier_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }


                //from_paid_amount starts
                if ($list_data['filter_search']['from_paid_amount'] != "" && !empty($list_data['filter_search']['from_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_paid_amount'] != "" && !empty($list_data['filter_search']['to_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //from_paid_amount ends


                //from_total_paid_amount starts
                if ($list_data['filter_search']['from_total_paid_amount'] != "" && !empty($list_data['filter_search']['from_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_total_paid_amount'] != "" && !empty($list_data['filter_search']['to_total_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_total_paid_amount ends


                //from_gain_loss starts
                if ($list_data['filter_search']['from_gain_loss'] != "" && !empty($list_data['filter_search']['from_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_gain_loss'] != "" && !empty($list_data['filter_search']['to_gain_loss'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_gain_loss']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.exchange_gain_loss <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.exchange_gain_loss <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_gain_loss ends

                //from_discount starts
                if ($list_data['filter_search']['from_discount'] != "" && !empty($list_data['filter_search']['from_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_discount'] != "" && !empty($list_data['filter_search']['to_discount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_discount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.discount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.discount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_discount ends

                //from_other_charges starts
                if ($list_data['filter_search']['from_other_charges'] != "" && !empty($list_data['filter_search']['from_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_other_charges'] != "" && !empty($list_data['filter_search']['to_other_charges'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_other_charges']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.other_charges <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.other_charges <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_round_off starts
                if ($list_data['filter_search']['from_round_off'] != "" && !empty($list_data['filter_search']['from_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.round_off >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_round_off'] != "" && !empty($list_data['filter_search']['to_round_off'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_round_off']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.round_off <=', $value);
                        }else{
                            $this->db->or_where('t.round_off <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_other_charges ends

                //from_pending_amount starts
                if ($list_data['filter_search']['from_pending_amount'] != "" && !empty($list_data['filter_search']['from_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.Invoice_pending >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_pending_amount'] != "" && !empty($list_data['filter_search']['to_pending_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.Invoice_pending <=', $value);
                        }else{
                            $this->db->or_where('t.Invoice_pending <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_pending_amount ends

                //from_invoice_amount starts
                if ($list_data['filter_search']['from_invoice_amount'] != "" && !empty($list_data['filter_search']['from_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_invoice_amount'] != "" && !empty($list_data['filter_search']['to_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_amount <=', $value);
                        }else{
                            $this->db->or_where('t.invoice_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                //from_invoice_amount ends


                if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.payment_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_converted_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_converted_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_reference_number'] != "" && !empty($list_data['filter_search']['filter_reference_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_reference_number']);
                    $j = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_number', $value);
                        }
                        else
                        {
                            
                            $this->db->or_where('t.reference_number', $value);
                        } $i++;
                        $j++;                        
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_paid_amount'] != "" && !empty($list_data['filter_search']['filter_paid_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.receipt_amount)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.receipt_amount)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_total_paid_amount'] != "" && !empty($list_data['filter_search']['filter_total_paid_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_total_paid_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.invoice_paid_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.invoice_paid_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_voucher_type'] != "" && !empty($list_data['filter_search']['filter_voucher_type']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_voucher_type']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_voucher_type', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_voucher_type', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "advance_voucher")
            {
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_payment_mode'] != "" && !empty($list_data['filter_search']['filter_payment_mode'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.from_account =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.payment_mode =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.advance_voucher_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.advance_voucher_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_billing_currency'] != "" && !empty($list_data['filter_search']['filter_billing_currency'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.currency_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }

                 //Taxable amount starts
                if ($list_data['filter_search']['from_taxable_amount'] != "" && !empty($list_data['filter_search']['from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_taxable_amount'] != "" && !empty($list_data['filter_search']['to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.taxable_value <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.taxable_value <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }if ($list_data['filter_search']['filter_utgst_from_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_from_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_advance'] != "" && !empty($list_data['filter_search']['filter_utgst_to_advance'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_advance']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } /*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/              
                //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['from_cgst_amount'] != "" && !empty($list_data['filter_search']['from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_cgst_amount'] != "" && !empty($list_data['filter_search']['to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['from_sgst_amount'] != "" && !empty($list_data['filter_search']['from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_sgst_amount'] != "" && !empty($list_data['filter_search']['to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['from_igst_amount'] != "" && !empty($list_data['filter_search']['from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_igst_amount'] != "" && !empty($list_data['filter_search']['to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['from_reciept_amount'] != "" && !empty($list_data['filter_search']['from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['to_reciept_amount'] != "" && !empty($list_data['filter_search']['to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends

                if ($list_data['filter_search']['filter_place_of_supply'] != "" ){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_state_id)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.billing_state_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_due'] != "" && !empty($list_data['filter_search']['filter_due'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_due']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_tax_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_tax_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_tax'] != "" && !empty($list_data['filter_search']['filter_tax']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_tax']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_sgst'] != "" && !empty($list_data['filter_search']['filter_sgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_sgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_igst'] != "" && !empty($list_data['filter_search']['filter_igst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_igst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            if ($list_data['section'] == "refund_voucher"){
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_payment_status'] != "" && !empty($list_data['filter_search']['filter_payment_status']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_status']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.reference_id =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.reference_id =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_utgst_from_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_from_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_from_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value){
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_utgst_to_refund'] != "" && !empty($list_data['filter_search']['filter_utgst_to_refund'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst_to_refund']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                /*if ($list_data['filter_search']['filter_utgst'] != "" && !empty($list_data['filter_search']['filter_utgst']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_utgst']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount =', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount =', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }*/if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_number'] != "" && !empty($list_data['filter_search']['filter_invoice_number']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_number']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.refund_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.refund_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } if ($list_data['filter_search']['filter_invoice_amount'] != "" && !empty($list_data['filter_search']['filter_invoice_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_invoice_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.billing_country_id)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //refund amount starts
                if ($list_data['filter_search']['filter_from_refund_amount'] != "" && !empty($list_data['filter_search']['filter_from_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_refund_amount'] != "" && !empty($list_data['filter_search']['filter_to_refund_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_refund_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //refund amount ends


                //billing country starts
                if ($list_data['filter_search']['filter_billing_country'] != "" && !empty($list_data['filter_search']['filter_billing_country'])) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_country']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_country_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_country_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //billing country ends

                //place of supply starts
                if ($list_data['filter_search']['filter_place_of_supply'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_place_of_supply']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.billing_state_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.billing_state_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //place of supply ends

                 //Billing Currency starts
                if ($list_data['filter_search']['filter_billing_currency'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_billing_currency']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.currency_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.currency_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Billing Currency ends

                //Payment Mode starts
                if ($list_data['filter_search']['filter_payment_mode'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_payment_mode']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.to_account', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.to_account', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                //Payment Mode ends                

                //Taxable amount starts
                if ($list_data['filter_search']['filter_from_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_from_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_taxable_amount'] != "" && !empty($list_data['filter_search']['filter_to_taxable_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_taxable_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sub_total <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sub_total <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //Taxable amount ends
                  


                 //cgst amount starts
                if ($list_data['filter_search']['filter_from_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_cgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_cgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_cgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_cgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_cgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //cgst amount ends

                  //sgst amount starts
                if ($list_data['filter_search']['filter_from_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_from_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_sgst_amount'] != "" && !empty($list_data['filter_search']['filter_to_sgst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_sgst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_sgst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_sgst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //sgst amount ends
                 

                  //igst amount starts
                if ($list_data['filter_search']['filter_from_igst_amount'] != "" && !empty($list_data['filter_search']['filter_from_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_igst_amount'] != "" && !empty($list_data['filter_search']['filter_to_igst_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_igst_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.voucher_igst_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.voucher_igst_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //igst amount ends

                 


                  //reciept amount starts
                if ($list_data['filter_search']['filter_from_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_from_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 
                if ($list_data['filter_search']['filter_to_reciept_amount'] != "" && !empty($list_data['filter_search']['filter_to_reciept_amount'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_reciept_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }                

                 //reciept amount ends


                 if ($list_data['filter_search']['filter_received_amount'] != "" ) {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_received_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.receipt_amount', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.receipt_amount', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                } 

                if ($list_data['filter_search']['filter_pending_amount'] != "" && !empty($list_data['filter_search']['filter_pending_amount']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_pending_amount']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('(t.from_account)', $value);
                        }
                        else
                        {
                            $this->db->or_where('(t.from_account)', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                
                
            }

            if ($list_data['section'] == "sales_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // Sales stock

            if ($list_data['section'] == "purchase_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // Purchase stock

            if ($list_data['section'] == "close_stock"){
                if ($list_data['filter_search']['filter_brand'] != "" && !empty($list_data['filter_search']['filter_brand'])){
                    $dat_arr = explode(",", $list_data['filter_search']['filter_brand']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.brand_name', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.brand_name', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
            // closing stock
            if ($list_data['section'] == "leads")
            {
                if ($list_data['filter_search']['filter_asr_no'] != "" && !empty($list_data['filter_search']['filter_asr_no']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_asr_no']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_date'] != "" && !empty($list_data['filter_search']['filter_from_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_to_date'] != "" && !empty($list_data['filter_search']['filter_to_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.lead_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.lead_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_customer_name'] != "" && !empty($list_data['filter_search']['filter_customer_name']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_customer_name']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.party_id', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.party_id', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_group'] != "" && !empty($list_data['filter_search']['filter_group']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_group']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.group', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.group', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_stages'] != "" && !empty($list_data['filter_search']['filter_stages']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_stages']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.stages', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.stages', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_source'] != "" && !empty($list_data['filter_search']['filter_source']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_source']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.source', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.source', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_business_type'] != "" && !empty($list_data['filter_search']['filter_business_type']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_business_type']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.business_type', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.business_type', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_from_next_action_date'] != "" && !empty($list_data['filter_search']['filter_from_next_action_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_from_next_action_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.next_action_date >=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.next_action_date >=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_to_next_action_date'] != "" && !empty($list_data['filter_search']['filter_to_next_action_date']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_to_next_action_date']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.next_action_date <=', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.next_action_date <=', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
                if ($list_data['filter_search']['filter_priority'] != "" && !empty($list_data['filter_search']['filter_priority']))
                {
                    $dat_arr = explode(",", $list_data['filter_search']['filter_priority']);
                    $j       = 0;
                    foreach ($dat_arr as $key => $value)
                    {
                        if ($i == 0 || $j == 0)
                        {
                            $this->db->group_start();
                            $this->db->where('t.priority', $value);
                        }
                        else
                        {
                            $this->db->or_where('t.priority', $value);
                        } $i++;
                        $j++;
                    } $this->db->group_end();
                }
            }
        } if (isset($list_data['limit']) && $list_data['limit'] != "")
        {
            $this->db->limit($list_data['limit'], $list_data['start']);
        }$query = $this->db->get();
        if ($query->num_rows() > 0)
        {
            // return $query->result();
            $res = $query->result();
            foreach ($res as $key => $value)
            {
                foreach ($value as $k => $val)
                {
                    $res[$key]->$k = str_replace("\'", "'", $val);
                }
            }
            return $res;
        }
        else
        {
            return null;
        }
    }
    public function getQueryRecords($sql)
    {
        return $this->db->query($sql)->result();
    }
    public function deleteData($table, $where)
    {
        $this->db->where($where);
        return $this->db->delete($table);
    }
    public function addVouchers($table, $reference_key, $reference_table, $var, $var1)
    {
        $headers  = $this->db->escape_str($var);
        $vouchers = $this->db->escape_str($var1);
    
        if ($this->db->insert($table, $headers)) {
            $transaction_id = $this->db->insert_id();
            foreach ($vouchers as $key => $value){
                $value[$reference_key] = $transaction_id;
                $this->db->insert($reference_table, $value); 
                $update_voucher = array();
                $update_voucher['ledger_id'] = $value['ledger_id'];
                $update_voucher['voucher_amount'] = $value['voucher_amount'];
                if($value['dr_amount'] > 0){
                    $update_voucher['amount_type'] = 'DR';
                }else{
                    $update_voucher['amount_type'] = 'CR';
                }
                $update_voucher['branch_id'] = $this->session->userdata('SESS_BRANCH_ID');
                $this->addBunchVoucher($update_voucher,$headers['voucher_date']);
            }
            return true;
        }else{
            return false;
        }
    }

    public function deleteVoucher($where,$table,$sub_table){
        $this->updateData($table, array('delete_status' => 1), $where);
        $ledgers = $this->getRecords('*', $sub_table, $where);
        $invoice_date = $this->getRecords('voucher_date',$table,$where);
        $ids = array();
        if(!empty($ledgers)){
            if($this->revertLedgerAmount((array)$ledgers,$invoice_date[0]->voucher_date)){
                $voucher_key = $this->array_key_first($where);
                foreach ($ledgers as $key => $value) {
                    $primary_key = $this->array_key_first((array)$value);
                    array_push($ids, $value->$primary_key);
                }
            }
            $this->db->where_in("{$primary_key}",$ids);
            $this->db->set('delete_status',1);
            $this->db->update($sub_table);
        }
        return true;
    }

    public function deleteCommonVoucher($table,$sub_table){
        $this->updateData($table['table'], array('delete_status' => 1), $table['where']);
        $ledgers = $this->getRecords('*', $sub_table['table'], $sub_table['where']);
        $invoice_date = $this->getRecords('voucher_date',$table['table'],$table['where']);
        $ids = array();
        if(!empty($ledgers)){
            if($this->revertLedgerAmount((array)$ledgers,$invoice_date[0]->voucher_date)){
                $voucher_key = $this->array_key_first($sub_table['where']);
                foreach ($ledgers as $key => $value) {
                    $primary_key = $this->array_key_first((array)$value);
                    array_push($ids, $value->$primary_key);
                }
            }
            $this->db->where_in("{$primary_key}",$ids);
            $this->db->set('delete_status',1);
            $this->db->update($sub_table['table']);
        }
        return true;
    }
    
    function array_key_first(array $arr) {
        foreach($arr as $key => $unused) {
            return $key;
        }
        return NULL;
    }
    
    public function revertLedgerAmount($response,$invoice_date){
        $revert = $pre_revert = array();
        $branch_id = $this->session->userdata('SESS_BRANCH_ID');
        $this->db->trans_start();
        foreach ($response as $key => $data) {
            $amount_type = 'CR';
            if($data->dr_amount > 0) $amount_type = 'DR';
            $voucher_amount = $data->voucher_amount;
            if($amount_type == 'DR'){
                $voucher_amount = (0 - $data->voucher_amount);
            }
            $colum_name = $this->getQuadrants($invoice_date);
            $year = date('Y',strtotime($invoice_date));
            $date = date('Y-m-d H:i:s');
            
            $this->db->query("UPDATE tbl_reports_bunch SET {$colum_name} = {$colum_name} + {$voucher_amount},total_bunch = total_bunch + {$voucher_amount},closing_balance=closing_balance+{$voucher_amount},updated_at='{$date}' WHERE year={$year} AND branch_id='{$branch_id}' AND ledger_id='{$data->ledger_id}'");
            $this->db->query("UPDATE tbl_reports_bunch SET closing_balance=closing_balance+{$voucher_amount},updated_at='{$date}' WHERE year > {$year} AND branch_id='{$branch_id}' AND ledger_id='{$data->ledger_id}'");
        }
        $this->db->trans_complete();
        if ($this->db->trans_status() === FALSE){
            $this->db->trans_rollback();
            return false;
        }else{
            $this->db->trans_commit();
            return true;
        }
    }
    public function addBunchVoucher($data,$invoice_date){
        $colum_name = $this->getQuadrants($invoice_date);
        $year = date('Y',strtotime($invoice_date));
        $branch_id = $this->session->userdata('SESS_BRANCH_ID');
        $ledger_id = $data['ledger_id'];
        $voucher_amount = $data['voucher_amount'];
        if($data['amount_type'] == 'CR'){
            $voucher_amount = (0 - $voucher_amount);
        }
        
        /* find closing balance*/
        $this->db->select('closing_balance');
        $this->db->where('year <',$year);
        $this->db->where('ledger_id',$data['ledger_id']);
        $this->db->where('branch_id',$data['branch_id']);
        $this->db->order_by("year","desc");
        $qry = $this->db->get('tbl_reports_bunch');
        $close_resp = $qry->result_array();
        $closing_balance = 0;
        if(!empty($close_resp)){
            $closing_balance = $close_resp[0]['closing_balance'];
        }
        /* check is already exist */
        $this->db->select("bunch_id");
        $this->db->where('year',$year);
        $this->db->where('ledger_id',$data['ledger_id']);
        $this->db->where('branch_id',$data['branch_id']);
        $r = $this->db->get('tbl_reports_bunch');
        $date = date('Y-m-d H:i:s');
        if($r->num_rows() == 0){
            $new_closing_balance = $closing_balance + $voucher_amount;
            $insert = array('ledger_id'=>$data['ledger_id'],
                            'branch_id' => $data['branch_id'],
                            'year' => $year,
                            "{$colum_name}" => $voucher_amount,
                            'total_bunch' => $voucher_amount,
                            'closing_balance' => $new_closing_balance,
                            'created_at' => date('Y-m-d H:i:s')
                        );
            $this->db->insert('tbl_reports_bunch',$insert);
        }else{
            $this->db->query("UPDATE tbl_reports_bunch SET {$colum_name} = $colum_name + {$voucher_amount},total_bunch = total_bunch + {$voucher_amount},closing_balance=closing_balance+{$voucher_amount},updated_at='{$date}' WHERE year={$year} AND branch_id='{$branch_id}' AND ledger_id='{$ledger_id}'");
        }
        $r = $this->db->query("UPDATE tbl_reports_bunch SET closing_balance=closing_balance+{$voucher_amount},updated_at='{$date}' WHERE year > {$year} AND branch_id='{$branch_id}' AND ledger_id='{$ledger_id}'");
        if($r){
            return true;
        }else{
            return false;
        }
    }
    public function updateBunchVoucher($data,$where ='',$invoice_date){
        $voucher_amount = $data['voucher_amount'];
        $branch_id = $this->session->userdata('SESS_BRANCH_ID');
        $data['branch_id'] = $branch_id;
        if($data['sales_voucher_id'] != '0'){
            $this->db->select('ledger_id,voucher_amount,dr_amount,cr_amount,voucher_date');
            $this->db->from('accounts_sales_voucher a');
            $this->db->join('sales_voucher s','a.sales_voucher_id=s.sales_voucher_id');
            $this->db->where($where);
            $this->db->where('s.sales_voucher_id',$data['sales_voucher_id']);
            $old_qry = $this->db->get();
            $old_resp = $old_qry->result_array();
            
            $old_ledger_id = $old_resp[0]['ledger_id'];
            $old_amount_type = 'CR';
            if($old_resp[0]['dr_amount'] > 0){
                $old_amount_type = 'DR';
            }
            $old_voucher_amount = $old_resp[0]['voucher_amount'];
            $old_invoice_date = $old_resp[0]['voucher_date'];
            $new_ledger_id = $data['ledger_id'];
            $new_amount_type = 'CR';
            $data['amount_type'] = 'CR';
            if($data['dr_amount'] > 0){
                $new_amount_type ='DR';
                $data['amount_type'] = 'DR';  
            }
            $new_voucher_amount = $data['voucher_amount'];
            /*if($old_ledger_id == $new_ledger_id and $old_amount_type == $new_amount_type and $old_voucher_amount == $new_voucher_amount and $old_invoice_date == $invoice_date){
                $voucher_amount = 0;
            }else{*/
                /* Revert the process */
                if($old_amount_type == 'DR'){
                    $old_voucher_amount = $old_voucher_amount * (-1);
                }
                $colum_name = $this->getQuadrants($old_invoice_date);
               
                $year = date('Y',strtotime($old_invoice_date));
                $date = date('Y-m-d H:i:s');

                /* check is already exist */
                $this->db->select("bunch_id");
                $this->db->where('year',$year);
                $this->db->where('ledger_id',$old_ledger_id);
                $this->db->where('branch_id',$branch_id);
                $r = $this->db->get('tbl_reports_bunch');
                $date = date('Y-m-d H:i:s');
                if($r->num_rows() == 0){
                    $insert = array('ledger_id'=>$old_ledger_id,
                            'branch_id' => $branch_id,
                            'year' => $year,
                            "{$colum_name}" => "{$colum_name} + {$old_voucher_amount}",
                            'total_bunch' => "total_bunch + {$old_voucher_amount}",
                            'closing_balance' => "closing_balance + {$old_voucher_amount}",
                            'created_at' => date('Y-m-d H:i:s')
                        );
                    $this->db->insert('tbl_reports_bunch',$insert);
                }else{
                    $this->db->query("UPDATE tbl_reports_bunch SET {$colum_name} = {$colum_name} + {$old_voucher_amount},total_bunch = total_bunch + {$old_voucher_amount},closing_balance=closing_balance+{$old_voucher_amount},updated_at='{$date}' WHERE year={$year} AND branch_id='{$branch_id}' AND ledger_id='{$old_ledger_id}'");
                    $this->db->query("UPDATE tbl_reports_bunch SET closing_balance=closing_balance+{$old_voucher_amount},updated_at='{$date}' WHERE year > {$year} AND branch_id='{$branch_id}' AND ledger_id='{$old_ledger_id}'");
                }
           /* }*/
        }
        return $this->addBunchVoucher($data,$invoice_date);
    }
    public function updateBunchVoucherCommon($post){
        $where = $post['where'];
        $data = $post['data'];
        $primary_key = $this->array_key_first($where);
        $invoice_date = $post['voucher_date'];
        $table = $post['table'];
        $sub_table = $post['sub_table'];
        $primary_key = $post['primary_id'];
        $sub_primary_id = $post['sub_primary_id'];
        $voucher_amount = $data['voucher_amount'];
        $branch_id = $this->session->userdata('SESS_BRANCH_ID');
        $data['branch_id'] = $branch_id;
        if($data[$sub_primary_id] != '0'){
            $this->db->select('ledger_id,voucher_amount,dr_amount,cr_amount,voucher_date');
            $this->db->from("{$sub_table} a");
            $this->db->join("{$table} s","a.{$sub_primary_id}=s.{$primary_key}");
            /*$this->db->where($where);*/
            $this->db->where("a.{$sub_primary_id}",$data[$sub_primary_id]);
            $this->db->where("a.delete_status",0);
            $old_qry = $this->db->get();
            $old_resp = $old_qry->result_array();
           
            $old_ledger_id = $old_resp[0]['ledger_id'];
            $old_amount_type = 'CR';
            if($old_resp[0]['dr_amount'] > 0){
                $old_amount_type = 'DR';
            }
            $old_voucher_amount = $old_resp[0]['voucher_amount'];
            $old_invoice_date = $old_resp[0]['voucher_date'];
            $new_ledger_id = $data['ledger_id'];
            $new_amount_type = 'CR';
            $data['amount_type'] = 'CR';
            if($data['dr_amount'] > 0){
                $new_amount_type ='DR';
                $data['amount_type'] = 'DR';  
            }
            $new_voucher_amount = $data['voucher_amount'];
            /*if($old_ledger_id == $new_ledger_id and $old_amount_type == $new_amount_type and $old_voucher_amount == $new_voucher_amount and $old_invoice_date == $invoice_date){
                $voucher_amount = 0;
            }else{*/
                /* Revert the process */
                if($old_amount_type == 'DR'){
                    $old_voucher_amount = $old_voucher_amount * (-1);
                }
                $colum_name = $this->getQuadrants($old_invoice_date);
               
                $year = date('Y',strtotime($old_invoice_date));
                $date = date('Y-m-d H:i:s');
                /* check is already exist */
                $this->db->select("bunch_id");
                $this->db->where('year',$year);
                $this->db->where('ledger_id',$old_ledger_id);
                $this->db->where('branch_id',$branch_id);
                $r = $this->db->get('tbl_reports_bunch');
                $date = date('Y-m-d H:i:s');
                if($r->num_rows() == 0){
                    $insert = array('ledger_id'=>$old_ledger_id,
                            'branch_id' => $branch_id,
                            'year' => $year,
                            "{$colum_name}" => "{$colum_name} + {$old_voucher_amount}",
                            'total_bunch' => "total_bunch + {$old_voucher_amount}",
                            'closing_balance' => "closing_balance + {$old_voucher_amount}",
                            'created_at' => date('Y-m-d H:i:s')
                        );
                    $this->db->insert('tbl_reports_bunch',$insert);
                }else{
                
                    $this->db->query("UPDATE tbl_reports_bunch SET {$colum_name} = {$colum_name} + {$old_voucher_amount},total_bunch = total_bunch + {$old_voucher_amount},closing_balance=closing_balance+{$old_voucher_amount},updated_at='{$date}' WHERE year={$year} AND branch_id='{$branch_id}' AND ledger_id='{$old_ledger_id}'");
                    $this->db->query("UPDATE tbl_reports_bunch SET closing_balance=closing_balance+{$old_voucher_amount},updated_at='{$date}' WHERE year > {$year} AND branch_id='{$branch_id}' AND ledger_id='{$old_ledger_id}'");
                }
           /* }*/
        }
        
        return $this->addBunchVoucher($data,$invoice_date);
    }
    function getQuadrants($invoice_date){
        $month = date('m',strtotime($invoice_date));
        $quadrants = $this->config->item('quadrants');
        foreach ($quadrants as $key => $value) {
            if(in_array($month, $value)){
                $colum_name = $key;
                break;
            }
        }
        return $colum_name;
    }
    public function checkIsUtgst($state_id){
        $result = $this->db->select('is_utgst')->from('states')->where('state_id',$state_id)->get()->result();
        if(!empty($result)){
            if($result[0]->is_utgst == '1'){
                return  '1';
            }else{
                return '0';
            }
        }else{
            return '0';
        }
    } 
    public function getRemianingModules($id)
    {
        $q = $this->db->select('m.*')->from('modules m')->where('m.delete_status', 0)->where('m.module_id NOT IN (select module_id from active_modules where delete_status=0 and branch_id=' . $id . ' )', NULL, FALSE)->get();
        return $q->result();
    }
    public function getActiveModules($id)
    {
        $q = $this->db->select('m.*')->from('modules m')->where('m.delete_status', 0)->where('m.module_id IN (select module_id from active_modules where delete_status=0 and branch_id=' . $id . ' )', NULL, FALSE)->get();
        return $q->result();
    }
    public function getRemainingSubModules($id, $module_id)
    {
        $q = $this->db->select('s.*')->from('sub_modules s')->where('s.delete_status', 0)->where('s.sub_module_id NOT IN (select sub_module_id from active_sub_modules where delete_status=0 and branch_id=' . $id . ' and module_id=' . $module_id . ' )', NULL, FALSE)->get();
        return $q->result();
    }
    public function getActiveRemianingModules($id, $branch_id)
    {
        $q = $this->db->select('am.*,m.module_name')->from('active_modules am')->join('modules m', 'am.module_id=m.module_id')->where('am.delete_status', 0)->where('am.branch_id', $branch_id)->where('am.module_id NOT IN (select module_id from user_accessibility where delete_status=0 and branch_id=' . $branch_id . ' and user_id=' . $id . ' )', NULL, FALSE)->group_by('m.module_id')->get();
        return $q->result();
    }
    public function getActiveRemianingModulesNew($id, $branch_id)
    {
        $q = $this->db->select('am.*,m.module_name')->from('group_accessibility am')->join('modules m', 'am.module_id=m.module_id')->join('users_groups g', 'g.group_id=am.group_id')->where('am.delete_status', 0)->where('am.branch_id', $branch_id)->where('g.user_id', $id)->where('am.module_id NOT IN (select module_id from user_accessibility where delete_status=0 and branch_id=' . $branch_id . ' and user_id=' . $id . ' )', NULL, FALSE)->group_by('m.module_id')->get();
        return $q->result();
    }
    public function getActiveRemianingModulesPrivilege($branch_id)
    {
        $q = $this->db->select('m.module_id,m.module_name')->from('active_modules am')->join('modules m', 'am.module_id=m.module_id')->where('am.delete_status', 0)->where('am.module_id NOT IN (select module_id from settings where delete_status=0 and branch_id=' . $branch_id . ')', NULL, FALSE)->group_by('m.module_id')->get();
        return $q->result();
    }
    public function getRecurrenceRecords()
    {
        $sql = "select * from recurrence where next_generation_date<CURDATE() and delete_status=0 and branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "' and financial_year_id='" . $this->session->userdata('SESS_FINANCIAL_YEAR_ID') . "'";
        $res = $this->db->query($sql);
        return $res->result();
    }
    private $customer_id;
    private $invoice_id;
    private $setStartDate;
    private $setEndDate;
    public function customer_id($customer_id)
    {
        $this->customer_id = $customer_id;
    }
    public function invoice_id($invoice_id)
    {
        $this->invoice_id = $invoice_id;
    }
    public function setStartDate($startDate)
    {
        $this->setStartDate = $startDate;
    }
    public function setEndDate($endDate)
    {
        $this->setEndDate = $endDate;
    }
    public function getOrders()
    {
        $this->db->select('s.*,c.*,u.first_name,u.last_name,cur.*');
        $this->db->from('sales s');
        $this->db->join('currency cur', 's.currency_id = cur.currency_id');
        $this->db->join('customer c', 's.sales_party_id = c.customer_id');
        $this->db->join('users u', 's.added_user_id = u.id');
        if (!empty($this->setStartDate) && !empty($this->setEndDate))
        {
            $this->db->where('DATE_FORMAT(FROM_UNIXTIME(`s`.`sales_date`),"%Y-%m-%d") BETWEEN \'' . $this->setStartDate . '\' AND \'' . $this->setEndDate . '\'');
        } if (!empty($this->customer_id))
        {
            $this->db->where('o.order_id', $this->customer_id);
        } if (!empty($this->invoice_id))
        {
            $this->db->like('o.name', $this->invoice_id, 'both');
        } $this->db->order_by('s.sales_date', 'DESC');
        $query = $this->db->get();
        return $query->result_array();
    }
    public function change_followup_status($type)
    {
        $sql="UPDATE followup f set follow_up_status = 1 WHERE f.type='$type' and f.date <= cast((now()) as date)";
        $this->db->query($sql);
        $sql="UPDATE followup f set follow_up_status = 2 WHERE f.type='$type' and f.date = cast((now() + interval 1 day) as date)";
        $this->db->query($sql);
        $sql="UPDATE followup f set follow_up_status = 3 WHERE f.type='$type' and f.date = cast((now() + interval 2 day) as date)";
        $this->db->query($sql);
        return true;
    }
    public function get_product_stock($stage){
        //echo "SELECT * FROM products where delete_status = 0 AND product_id IN (SELECT item_id from product_damaged where stock_type = '".$stage."')";
        //exit;
        $query = $this->db->query("SELECT * FROM products where delete_status = 0 AND  branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "' AND product_id IN (SELECT item_id from product_damaged where stock_type = '".$stage."')");
        $result = $query->result();
        return $result;
       
    }
    public function get_product_stock_individual($id){
        //echo "SELECT * FROM products where delete_status = 0 AND product_id IN (SELECT item_id from product_damaged where stock_type = '".$stage."')";
        //exit;
        $query = $this->db->query("SELECT PT.product_id,PT.product_code,PT.product_name, PR.purchase_date as 'REF_DATE', PR.purchase_invoice_number  as 'REF_NUM', P.purchase_item_quantity as 'QTY', 'PURCHASE' as TYPE
            FROM products PT
            JOIN purchase_item P ON PT.product_id = P.item_id and p.item_type = 'product'
            JOIN purchase PR ON P.purchase_id = PR.purchase_id
            WHERE
            PT.product_id = $id
            UNION
            SELECT PT.product_id,PT.product_code,PT.product_name, PRD.purchase_debit_note_date as 'REF_DATE', PRD.purchase_debit_note_invoice_number as 'REF_NUM',PD.purchase_debit_note_item_quantity as 'QTY', 'PURCHASE_DEBIT_NOTE' as TYPE
            FROM products PT
            JOIN purchase_debit_note_item PD ON PT.product_id = PD.item_id and PD.item_type = 'product'
            JOIN purchase_debit_note PRD ON PD.purchase_debit_note_id = PRD.purchase_debit_note_id
            WHERE
            PT.product_id = $id
            UNION 
        SELECT PT.product_id,PT.product_code,PT.product_name,PRC.purchase_credit_note_date as 'REF_DATE', PRC.purchase_credit_note_invoice_number as 'REF_NUM',PC.purchase_credit_note_item_quantity as 'QTY', 'PURCHASE_CREDIT_NOTE' as TYPE
        FROM products PT
        JOIN purchase_credit_note_item PC ON PT.product_id = PC.item_id and pC.item_type = 'product'
        JOIN purchase_credit_note PRC ON PC.purchase_credit_note_id = PRC.purchase_credit_note_id
        WHERE
        PT.product_id  = $id AND  PT.branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "' ");
        $result = $query->result();
        return $result;
       
    }
    public function get_product_stock_damaged( $id){
       // $id = $this->input->post('id');
       
         $query = $this->db->query("SELECT PT.product_id,PT.product_code,PT.product_name, D.reference_date as 'REF_DATE', D.reference_number  as 'REF_NUM', D.quantity as 'QTY',D.product_damage_id,D.comments, D.stock_type
            FROM products PT
            JOIN product_damaged D ON PT.product_id = D.item_id and D.stock_type IN ('damaged','missing')
            WHERE D.reference_type = 'from_product' AND
            PT.product_id = $id AND  PT.branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "'");
          $result = $query->result();
        return $result;
       
    }
    public function get_product_damaged_products($id){
       // $id = $this->input->post('id');
       
         $query = $this->db->query("SELECT PT.product_id,PT.product_code,PT.product_name, D.reference_date as 'REF_DATE', D.reference_number  as 'REF_NUM', D.quantity as 'QTY',D.product_damage_id,D.comments, D.stock_type
            FROM products PT
            JOIN product_damaged D ON PT.product_id = D.item_id and D.stock_type IN ('fixed','missing' ) and D.stock_refer IN ('damaged')
            WHERE
            PT.product_id = $id AND  PT.branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "' ");
          $result = $query->result();
        return $result;
       
    }
    public function get_product_missing_products($id){
       // $id = $this->input->post('id');
         $query = $this->db->query("SELECT PT.product_id,PT.product_code,PT.product_name, D.reference_date as 'REF_DATE', D.reference_number  as 'REF_NUM', D.quantity as 'QTY',D.product_damage_id,D.comments, D.stock_type
            FROM products PT
            JOIN product_damaged D ON PT.product_id = D.item_id and D.stock_type IN ('found','damaged') and D.stock_refer IN ('missing')
            WHERE
            PT.product_id = $id AND  PT.branch_id='" . $this->session->userdata('SESS_BRANCH_ID') . "' ");
          $result = $query->result();
        return $result;
       
    }
}
